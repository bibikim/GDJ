<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <!-- 데이터 주고받는 통신 방법 -->
    <script>
        /*
            AJAX

            1. Asynchronous Javascript And Xml
            2. 자바스크립트와 XML간 비동기 통신 (XML뿐만 아니라 JSON 데이터도 가능)
            3. 통신 방식
                1) 동기 통신(순서대로 티키타카하는 방식)
                    (1) 순서대로 통신
                    (2) 요청을 하고, 응답이 올 때까지 기다림
                    (3) 느림
                2) 비동기 통신
                    (1) 순서를 지키지 않는 통신
                    (2) 응답이 오지 않더라도 요청을 계속(기다리지 않아도 계속 요청할 수 있으니 편함)
                    (3) 응답이 오면 해당 응답만 처리하면 됨
            4. 페이지 전체를 로드하지 않고, 페이지 일부만 요청해서 처리하는 기능()
                ex) 댓글을 작성할 때, 페이지 전체가 깜빡이면서 전체가 로드되는 것은 ajax 처리 하지 않은 것!
            5. 자바스크립트의 XMLHttpRequest 객체가 AJAX 처리를 담당함(객체 이름이니까 대소문자 지켜줘야해용)
        */
    </script>

    <div id="box1"></div>
    <script>
        
        // data.txt 파일이 서버가 보낸 데이터라고 가정~

        // 1. XMLHttpRequest 객체 생성
        var xhr = new XMLHttpRequest();

        // 2. open() - 요청 정보 만들기
        //    open(HTTP메소드, 요청서버경로, 통신방식)
        //     1) HTTP 메소드
        //        (1) GET  : GET방식  (기본)
        //        (2) POST : POST방식
        //     2) 요청서버경로
        //         /컨텍스트패스/URLMapping 
        //     3) 통신방식
        //        (1) 동기 통신   : false
        //        (2) 비동기 통신 : true 
        xhr.open('GET', 'data.txt', true);

        // 3. send() - 요청하기
        xhr.send();

        // 4. 응답 처리
        //    응답이 오는지 점검하기 위한 readystatechange 이벤트가 필요 (응답이 오면 호출되는(동작) 이벤트)
        //      ㄴ> 요청만 하는게 아니라 응답이 왔는지 점검을 해줘야 되는 것이 비동기 통신 방식
        xhr.onreadystatechange = function(event) {
            // 응답이 오면 이 이벤트가 동작함
            // 응답에 관련된 속성
            // 1. readyState (통신 확인)
            //     1) 0(OPENED)
            //     2) 1(UNSEND)
            //     3) 2(HEADERS_RECEIVE)
            //     4) 3(LOADING) 
            //     5) 4(DONE)     -> 이것만 기억하면 됨.  4가 아니면 제대로 통신된 것 아님!
            // 2. status (응답 코드)
            //     1) 200 : 응답 성공    -> 이것만 기억
            //     2) 40X : 요청 실패(client 잘못)
            //     3) 50X : 서버 오류(server 잘못)
            if(xhr.readyState == 4 && xhr.status == 200) {   // 정상 실행되었다면~
                // 응답 데이터 속성(property값)
                // 1. 텍스트 형식 응답 : responseText
                // 2. XML    형식 응답 : responseXML
                // 3. JSON   형식 응답 : JSON.parse(repsonseText)   (text형태로 오기 때문에. 12_json.html 참고)
                document.getElementById('box1').textContent = xhr.responseText;
                
            }
        }

    </script>
</body>
</html>